<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
  <meta charset="UTF-8"/>
  <title>회원 관리</title>

  <!-- 공통 head 프래그먼트 삽입 -->
  <th:block th:insert="~{layout :: head}"></th:block>

  <!-- 페이지 전용 CSS -->
  <style>
    /* ───────── 색상 변수 ───────── */
    :root{
      --bs-primary:#337ab7;
      --bs-primary-dark:#2e6da4;
    }

    /* ───────── 기본 레이아웃 & 타이포 ───────── */
    body{font-family:"Helvetica Neue",Arial,sans-serif;padding:20px;background:#f9f9fb}
    h1,h2{color:var(--bs-primary)}
    label{display:inline-block;margin-top:8px}

    .layout{max-width:940px;margin:0 auto}
    .content{padding:16px}

    /* ───────── 테이블 ───────── */
    table{width:100%;border-collapse:collapse;margin-top:12px}
    th,td{border:1px solid #666;padding:8px;text-align:left}
    thead th{background:var(--bs-primary);color:#fff}

    /* ───────── 폼 구성 요소 ───────── */
    input[type="text"],input[type="password"],input[type="email"],
    input[type="number"],select{
      padding:6px 10px;
      border:1px solid #ccc;
      border-radius:4px;
      width:220px;
      box-sizing:border-box
    }

    /* ───────── 버튼 (아웃라인 프라이머리) ───────── */
    button{
      color:var(--bs-primary);
      border:2px solid var(--bs-primary);
      background:#fff;
      padding:6px 14px;
      border-radius:4px;
      font-weight:600;
      cursor:pointer;
      transition:all .25s
    }
    button:hover{
      color:#fff;
      background:var(--bs-primary);
      border-color:var(--bs-primary-dark)
    }

    /* 링크 색상 */
    a{color:var(--bs-primary)}
    a:hover{color:var(--bs-primary-dark)}
  </style>
</head>

<body>
<header th:replace="~{layout :: header}"></header>

<div class="layout">
  <main class="content">
    <h1>회원 관리 (Admin 전용)</h1>

    <!-- 신규 회원 추가 -->
    <h2>신규 회원 추가</h2>
    <form th:action="@{/admin/users/create}" method="post">
      <label>아이디:
        <input type="text" name="username" required/>
      </label><br>
      <label>비밀번호:
        <input type="password" name="password" required/>
      </label><br>
      <label>이메일:
        <input type="email" name="email"/>
      </label><br>
      <label>권한:
        <select name="authority">
          <option value="0">관리자</option>
          <option value="1" selected>수강생</option>
          <option value="2">강사</option>
        </select>
      </label>
      <button type="submit">추가</button>
    </form>

    <!-- 회원 목록 -->
    <h2>회원 목록</h2>
    <table>
      <thead>
        <tr><th>ID</th><th>아이디</th><th>이메일</th><th>권한</th><th>수정</th><th>삭제</th></tr>
      </thead>
      <tbody>
        <tr th:each="u : ${users}">
          <td th:text="${u.id}"></td>
          <td>
            <form th:action="@{/admin/users/update}" method="post">
              <input type="hidden" name="id" th:value="${u.id}"/>
              <input type="text" name="username" th:value="${u.username}" required/>
          </td>
          <td><input type="email" name="email" th:value="${u.email}"/></td>
          <td>
              <select name="authority">
                <option th:selected="${u.authority==0}" value="0">관리자</option>
                <option th:selected="${u.authority==1}" value="1">수강생</option>
                <option th:selected="${u.authority==2}" value="2">강사</option>
              </select>
          </td>
          <td><button type="submit">수정</button></form></td>
          <td>
            <form th:action="@{/admin/users/delete}" method="post"
                  onsubmit="return confirm('삭제하시겠습니까?');">
              <input type="hidden" name="id" th:value="${u.id}"/>
              <button type="submit">삭제</button>
            </form>
          </td>
        </tr>
      </tbody>
    </table>

    <!-- 코드 생성 -->
    <h2>코드 생성</h2>
    <form th:action="@{/admin/users/createCode}" method="post">
      <label>권한:
        <select name="authority">
          <option value="0">관리자</option>
          <option value="1" selected>수강생</option>
          <option value="2">강사</option>
        </select>
      </label>
      <label>생성 갯수:
        <input type="number" name="value" required step="1" max="50"/>
      </label><br>
      <button type="submit">생성</button>
    </form>

    <table>
      <thead><tr><th>CODE</th><th>삭제</th></tr></thead>
      <tbody>
        <tr th:each="c : ${codes}">
          <td th:text="${c.roleCode}"></td>
          <td>
            <form th:action="@{/admin/users/deleteCode}" method="post">
              <input type="hidden" name="roleCode" th:value="${c.roleCode}"/>
              <button type="submit">삭제</button>
            </form>
          </td>
        </tr>
      </tbody>
    </table>

    <p><a th:href="@{/}">메인으로</a></p>
  </main>
</div>
</body>
</html>