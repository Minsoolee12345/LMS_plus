<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
  <!-- 공통 head 프래그먼트 -->
  <th:block th:insert="~{layout :: head}"></th:block>

  <style>
    /* ─── 컬러 팔레트 (초기 파란색 계열로 복귀) ─── */
    :root{
      --bs-primary:#337ab7;      /* ★ 원래 파란색 */
      --bs-primary-dark:#2e6da4; /* ★ 원래 어두운 파란색 */
      --bs-danger:#e74c3c;
      --bs-danger-dark:#c0392b;

      --bs-bg:#f0f2f5;
      --bs-card:#ffffff;
      --bs-border:#e0e0e0;
      --bs-text:#343a40;
    }

    /* ─── 기본 레이아웃 & 타이포 ─── */
    body{
      font-family:Arial,Helvetica,sans-serif;
      padding:24px;
      background:var(--bs-bg);
      color:var(--bs-text);
    }
    h1,h2{color:var(--bs-primary);margin:0 0 20px;font-weight:600}
    h3{color:#555;margin:12px 0;font-weight:500}

    .layout{max-width:1360px;margin:0 auto}
    .content{padding:16px}

    /* ─── 강의 블록 카드 ─── */
    .lecture-block{
      background:var(--bs-card);
      border:1px solid var(--bs-border);
      border-radius:8px;
      box-shadow:0 4px 12px rgba(0,0,0,.04);
      padding:20px;
      margin-bottom:32px;
    }

    /* ─── 테이블 ─── */
    .table-wrapper{overflow-x:auto}
    table{
      width:100%;
      border-collapse:collapse;
      margin-top:.75rem;
      table-layout:fixed;
    }
    thead{background:var(--bs-primary);color:#fff}
    th,td{
      padding:.8rem 1rem;
      text-align:center;
      border-bottom:1px solid var(--bs-border);
      word-break:break-word;
    }
    tbody tr:nth-child(odd){background:#fafafa}
    tbody tr:hover{background:#f5f9ff}

    thead th:nth-child(1),tbody td:nth-child(1){width:30%}
    thead th:nth-child(2),tbody td:nth-child(2){width:20%}
    thead th:nth-child(3),tbody td:nth-child(3){width:50%}

    /* ─── 버튼 ─── */
    button{
      background:var(--bs-primary);
      color:#fff;
      border:none;
      padding:.5rem 1rem;
      margin:0 .3rem;
      font-size:.9rem;
      border-radius:5px;
      cursor:pointer;
      box-shadow:0 2px 4px rgba(0,0,0,.05);
      transition:background-color .15s,transform .15s;
    }
    button:hover{background:var(--bs-primary-dark)}
    button:active{transform:scale(.97)}

    form[action*="/reject"] button,
    form[action*="/exclude"] button{background:var(--bs-danger)}
    form[action*="/reject"] button:hover,
    form[action*="/exclude"] button:hover{background:var(--bs-danger-dark)}

    @media(max-width:768px){
      h1,h2{font-size:1.35rem}
      h3{font-size:1.1rem}
      th,td{padding:.6rem;font-size:.84rem}
      button{padding:.4rem .8rem;font-size:.8rem}
    }
  </style>
</head>

<body>
  <header th:replace="~{layout :: header}"></header>

  <div class="layout">
    <main class="content">
      <h1>내 수강생</h1>

      <!-- 대기 중 -->
      <h2>대기 중인 신청</h2>
      <div th:each="entry : ${pendingMap}" class="lecture-block">
        <h3 th:text="${entry.key.title}">강의 제목</h3>
        <div class="table-wrapper">
          <table>
            <thead>
              <tr><th>ID</th><th>진행도</th><th>액션</th></tr>
            </thead>
            <tbody>
              <tr th:each="stu : ${entry.value}">
                <td th:text="${stu.username}"></td>
                <td th:text="${stu.progress + '%'}"></td>
                <td>
                  <form th:action="@{/instructor/students/{subId}/accept(subId=${stu.subId})}"
                        method="post" style="display:inline">
                    <button type="submit">수락</button>
                  </form>
                  <form th:action="@{/instructor/students/{subId}/reject(subId=${stu.subId})}"
                        method="post" style="display:inline">
                    <button type="submit">거절</button>
                  </form>
                </td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>

      <!-- 승인됨 -->
      <h2>승인된 수강생</h2>
      <div th:each="entry : ${approvedMap}" class="lecture-block">
        <h3 th:text="${entry.key.title}">강의 제목</h3>
        <div class="table-wrapper">
          <table>
            <thead>
              <tr><th>ID</th><th>진행도</th><th>액션</th></tr>
            </thead>
            <tbody>
              <tr th:each="stu : ${entry.value}">
                <td th:text="${stu.username}"></td>
                <td th:text="${stu.progress + '%'}"></td>
                <td>
                  <form th:action="@{/instructor/students/{subId}/exclude(subId=${stu.subId})}"
                        method="post">
                    <button type="submit">제외</button>
                  </form>
                </td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
    </main>
  </div>
</body>
</html>